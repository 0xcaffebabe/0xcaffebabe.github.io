---
layout: post
title:  "设计模式(三):工厂方法模式"
date:   2019-12-５T018:00:00
category: 设计模式
tags: [设计模式]
---

定义一个接口，让子类创建该接口的实例，也就是将是实例化延迟到工厂的子类

# 工厂方法模式

工厂方法与抽象工厂很像，理论上，抽象工厂是使用工厂模式实现的。

我们只需要对抽象工厂稍加修改，即可得到一个工厂方法模式

## 工厂顶类

```java
abstract class Factory{

    abstract Product create();
}
```

## 产品

```java
interface Product{}
```

## 具体工厂

```java
class ConcreteFactory extends Factory{

    @Override
    Product create() {
        class ProductA implements Product{};
        return new ProductA();
    }
}
```

## 使用

```java
Factory factory = new ConcreteFactory();
Product product = factory.create();
```

### 钩子方法

工厂方法提供了另外一种功能，钩子方法。

我们对顶层工厂类稍加修改：

```java
abstract class Factory{

    Product get(){
        Product product = create();
        dosomething(product);
        return product;
    }

    abstract Product create();

    abstract void dosomething(Product product);
}
```

我们可以对顶层工厂类稍加修改，就可以实现一个钩子方法，这个钩子方法的具体内容是由子类提供的。

## 类图

![](https://images0.cnblogs.com/i/657084/201408/202109111907872.png)

## 使用时机

- 一个类不知道它所要创建的类
- 一个类创建的类由其子类创造

## 实例

JDBC中获取连接，以及连接获取statement就使用的是工厂方法模式

```java
Connection conn = DriverManager.getConnection("url");
PreparedStatement statement = conn.prepareStatement("sql");
```

这里的`Connection`与`PreparedStatement`都是一个接口，具体的实现类由数据库厂商提供。



